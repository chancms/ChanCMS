import{r as Z,N as Q,s as ee,g as te,q as oe,F as ae,I as le,v as ne,x as re,y as se,u as ce,a as g,A as ie}from"./element-plus.js";import{u as de,a as ue}from"./vue-router.js";import{I as me,i as pe,v as fe,H as _e,F as ve}from"./@element-plus.js";import{s as ye,b as T}from"./article.js";import{f as ge}from"./category.js";import{_ as we,a as he,t as ke}from"./index.js";import{r as n,W as be,w as Ce,n as xe,aj as Ee,c as B,o as w,a as h,O as o,L as l,u as m,a3 as p,T as $e,K as Se,H as Ve,Q as R}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const Te={class:"bg-fff radius-6 pd-20 mb-10"},Be={class:"radius-6 bg-fff pd-20"},Re={class:"flex justify-between align-c"},Fe=["href"],qe={__name:"index",setup(Ie){const _=de(),F=ue(),f=n(location.origin),k=n(null),q=n(null),v=n(!0),b=n([]),C=n([]),x=n(0),s=n(1),d=n(0),E=n([]),r=be({keywords:"",categorySelected:[]}),$=e=>{e&&k.value.resetFields(),_.replace({name:"article-index",query:{cur:1,cid:0,keywords:""}}),s.value=1,r.keywords="",d.value=0,u()},S=()=>{_.replace({name:"article-index",query:{cur:s.value,cid:d.value,keywords:r.keywords}}),u()},u=async()=>{try{v.value=!0;const e=await ye(s.value,r.keywords,d.value);e.code===200&&(b.value=[...e.data.list],x.value=e.data.count,s.value=e.data.current,v.value=!1)}catch(e){console.error(e)}},I=e=>{s.value=e,S()},N=e=>{C.value=e},P=async()=>{try{const e=await ge();if(e.code===200){console.log("00---000",e.data);const t=he(ke(e.data));E.value=[...t]}}catch(e){console.error(e)}},j=e=>{d.value=e[e.length-1]},A=e=>{_.push({name:"article-edit",params:{id:e.id}})},D=()=>{},L=async()=>{const e=C.value.map(t=>t.id).join(",");try{(await T(e)).code===200&&(g({message:"删除成功 ^_^",type:"success"}),u())}catch(t){console.error(t)}},M=e=>{const t=e.type=="0"?"".concat(f.value,"/article-").concat(e.id,".html"):"".concat(f.value).concat(e.path,"/page-").concat(e.id,".html");window.open(t)},U=e=>{ie.confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{(await T(e.id)).code===200&&(g({message:"文章删除成功 ^_^",type:"success"}),u())}catch(t){console.error(t)}}).catch(()=>{g({type:"info",message:"已取消删除"})})};return Ce(()=>F.query,e=>{s.value=e.cur,d.value=e.cid,r.keywords=e.keywords||"",u()},{immediate:!0}),xe(()=>{P()}),(e,t)=>{const H=Q,y=Z,z=ee,c=te,K=oe,O=ae,W=Ee("router-link"),i=ne,G=re,J=se,X=ce,Y=le;return w(),B("div",null,[h("div",Te,[o(K,{inline:!0,model:r,"label-width":"68px",ref_key:"formRef",ref:k},{default:l(()=>[o(y,{label:"栏目筛选",prop:"categorySelected"},{default:l(()=>[o(H,{"show-all-levels":!1,modelValue:r.categorySelected,"onUpdate:modelValue":t[0]||(t[0]=a=>r.categorySelected=a),options:E.value,onChange:j},null,8,["modelValue","options"])]),_:1}),o(y,{label:"标题",prop:"keywords"},{default:l(()=>[o(z,{placeholder:"请输入文章标题","suffix-icon":m(me),modelValue:r.keywords,"onUpdate:modelValue":t[1]||(t[1]=a=>r.keywords=a),clearable:"",onClear:$},null,8,["suffix-icon","modelValue"])]),_:1}),o(y,null,{default:l(()=>[o(c,{type:"primary",onClick:S,round:""},{default:l(()=>t[4]||(t[4]=[p("搜索",-1)])),_:1,__:[4]}),o(c,{onClick:t[2]||(t[2]=a=>$("formRef")),round:""},{default:l(()=>t[5]||(t[5]=[p("清空",-1)])),_:1,__:[5]})]),_:1})]),_:1},8,["model"])]),h("div",Be,[h("div",Re,[o(O,{"confirm-button-text":"确定","cancel-button-text":"取消",icon:m(pe),"icon-color":"#626AEF",title:"此操作将永久删除, 是否继续?",onConfirm:L,onCancel:D},{reference:l(()=>[o(c,null,{default:l(()=>t[6]||(t[6]=[p("删除",-1)])),_:1,__:[6]})]),_:1},8,["icon"]),o(W,{class:"mt-10",to:"/article/add"},{default:l(()=>[o(c,{type:"primary",round:""},{default:l(()=>t[7]||(t[7]=[p("新增",-1)])),_:1,__:[7]})]),_:1})]),$e((w(),Se(G,{ref_key:"multipleTableRef",ref:q,data:b.value,"tooltip-effect":"dark","row-key":"id",onSelectionChange:N},{default:l(()=>[o(i,{type:"selection"}),o(i,{prop:"id",label:"编号",width:"80",fixed:""}),o(i,{prop:"title",label:"标题"},{default:l(a=>[a.row.status===0?(w(),B("a",{key:0,class:"block",href:a.row.type=="0"?"".concat(f.value,"/article-").concat(a.row.id,".html"):"".concat(f.value).concat(a.row.path,"/page-").concat(a.row.id,".html"),target:"_blank"},R(a.row.title),9,Fe)):Ve("",!0)]),_:1}),o(i,{prop:"name",label:"栏目",width:"80"}),o(i,{prop:"createdAt",label:"更新时间",width:"170"}),o(i,{prop:"status",label:"状态",width:"60"},{default:l(a=>[p(R(a.row.status==0?"显示":"隐藏"),1)]),_:1}),o(i,{fixed:"right",label:"操作",width:"150"},{default:l(a=>[o(c,{icon:m(fe),circle:"",onClick:V=>M(a.row)},null,8,["icon","onClick"]),o(c,{icon:m(_e),circle:"",onClick:V=>A(a.row)},null,8,["icon","onClick"]),o(c,{icon:m(ve),circle:"",onClick:V=>U(a.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[Y,v.value]]),o(X,{type:"flex",class:"mt-20",justify:"space-between"},{default:l(()=>[o(J,{background:"",layout:"prev, pager, next",onCurrentChange:I,"page-size":20,total:x.value,currentPage:s.value,"onUpdate:currentPage":t[3]||(t[3]=a=>s.value=a),"hide-on-single-page":""},null,8,["total","currentPage"])]),_:1})])])}}},ot=we(qe,[["__scopeId","data-v-b0ef9270"]]);export{ot as default};
