System.register(["./element-plus-legacy.js","./@vue-legacy.js","./vue-router-legacy.js","./category-legacy.js","./article-legacy.js","./tag-legacy.js","./sys_config-legacy.js","./tinymce-legacy.js","./upload-legacy.js","./index-legacy.js","./dayjs-legacy.js","./ace-builds-legacy.js","./@element-plus-legacy.js","./lodash-es-legacy.js","./@popperjs-legacy.js","./async-validator-legacy.js","./@ctrl-legacy.js","./memoize-one-legacy.js","./normalize-wheel-es-legacy.js","./js-cookie-legacy.js","./pinia-legacy.js","./pinia-plugin-persist-legacy.js","./axios-legacy.js","./nprogress-legacy.js","./@fingerprintjs-legacy.js","./tslib-legacy.js","./saduo-legacy.js"],function(e,l){"use strict";var a,t,u,d,o,s,n,r,i,c,m,p,v,f,g,y,V,b,_,h,w,j,x,U,k,C,A,I,S,D,z,O,R,P,T,q,E,B,F,J,L,M,N,G,$,H,K,Q,Z,W,X,Y,ee,le,ae,te,ue;return{setters:[e=>{a=e.n,t=e.m,u=e.u,d=e.G,o=e.r,s=e.N,n=e.s,r=e.O,i=e.P,c=e.Q,m=e.R,p=e.S,v=e.T,f=e.b,g=e.U,y=e.g,V=e.o,b=e.C,_=e.I,h=e.L,w=e.M,j=e.B,x=e.D,U=e.q,k=e.a},e=>{C=e.V,A=e.r,I=e.n,S=e.ai,D=e.c,z=e.o,O=e.a,R=e.U,P=e.K,T=e.J,q=e.G,E=e.R,B=e.a2,F=e.H,J=e.aa,L=e.S},e=>{M=e.u},e=>{N=e.f},e=>{G=e.f,$=e.d,H=e.c},e=>{K=e.s},e=>{Q=e.v},e=>{Z=e.t,W=e._},e=>{X=e.u},e=>{Y=e._,ee=e.a,le=e.t,ae=e.s,te=e.b,ue=e.f},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var l=document.createElement("style");l.textContent="[data-v-ea353216] .tiny-textarea{height:436px}.cover[data-v-ea353216]{padding:6px}.cover div[data-v-ea353216]{width:120px;height:120px;cursor:pointer;margin:5px}.w-300[data-v-ea353216]{width:300px!important}[data-v-ea353216] .el-drawer{width:280px!important}[data-v-ea353216] .el-drawer__body{padding:0}.imgs-btn[data-v-ea353216]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);color:#fff;font-size:20px;cursor:pointer;justify-content:center;align-items:center;gap:30px;display:none;transition:all .3s}.img-item[data-v-ea353216]{position:relative;margin-right:10px;cursor:pointer;overflow:hidden;border-radius:5px;border:1px solid #f2f2f2}.img-item:hover .imgs-btn[data-v-ea353216]{display:flex}.upload-icon[data-v-ea353216]{border:1px dashed #dcdfe6;border-radius:6px;cursor:pointer;position:relative;overflow:hidden;transition:.2s;font-size:28px;color:#8c939d;width:100px;height:100px;text-align:center}\n/*$vite$:1*/",document.head.appendChild(l);const de={class:"bg-fff pd-10 radius-6"},oe={class:"mr-10 ml-10"},se={class:"mr-10 ml-10 mb-20"},ne={class:"cover row"},re={key:0,class:"cover flex align-center"},ie={class:"imgs-btn"};e("default",Y({__name:"add",setup(e){const l=M(),Y=C({...Z}),ce=A(!0),me=A([-1]),pe={checkStrictly:!0},ve=A("first"),fe=A("0"),ge=A([]),ye=A([]),Ve=A([]),be=A(!1),_e=A(!1),he=A(1),we=A([]),je=A(),xe=A(),Ue=A(""),ke=C({cid:0,title:"",shortTitle:"",tagId:"",attr:[],articleView:"",source:"",author:"",description:"",img:"",createdAt:new Date,updatedAt:new Date,content:"欢迎使用ChanCMS系统",status:"0",pv:1,link:""}),Ce=A([]),Ae=A(""),Ie=A(!1),Se=A(1),De=A(!1),ze=A(["/public/cover/01.jpg","/public/cover/02.jpg","/public/cover/03.jpg","/public/cover/04.jpg","/public/cover/05.jpg","/public/cover/06.jpg","/public/cover/07.jpg","/public/cover/08.jpg","/public/cover/09.jpg","/public/cover/10.jpg"]),Oe=async e=>{try{const l=await K(Se.value,e);200===l.code&&l.data&&(we.value=l.data.list.map(e=>({label:e.name,value:e.id})))}catch(l){console.error(l)}},Re=e=>{-1!==e[0]?(ke.cid=e[e.length-1],Pe(ke.cid)):Ce.value=[]},Pe=async e=>{try{const l=await G(e);200===l.code&&(l.data.fields.forEach(e=>{if(e.default&&e.default.includes("[")&&e.default.includes("options")){const l=JSON.parse(e.default);e.default=l.options||[]}"8"===e.type&&(e.values=[])}),Ce.value=l.data.fields)}catch(l){console.error(l)}},Te=()=>{ce.value=!1},qe=e=>{fe.value=e.index},Ee=e=>{if(-1===e.type.indexOf("image"))return k({message:"上传文件只能是图片格式",type:"success"}),!1;je.value=e;const l=new FileReader;return l.onload=async e=>{let l;l="object"==typeof e.target.result?window.URL.createObjectURL(new Blob([e.target.result])):e.target.result,Ue.value=l},l.readAsArrayBuffer(e),!0},Be=async()=>{if(je.value.size/1024/1024>.2)return k({message:"上传图片必须小于200k",type:"success"}),!1;const e=new FormData;e.append("file",je.value);const l=await X(e,"1");200===l.code&&(ke.img=l.data.path)},Fe=e=>-1===e.type.indexOf("image")?(k({message:"上传文件只能是图片格式",type:"success"}),!1):e.size/1024/1024>.2?(k({message:"上传图片必须小于200k",type:"success"}),!1):void 0,Je=async e=>{const{data:{index:l},file:a}=e,t=new FormData;t.append("file",a);const u=await X(t,"2");if(200===u.code){const e=u.data.map(e=>({name:e.filename,url:e.path}));Array.isArray(Ce.value[l].values)?Ce.value[l].values.push(...e):Ce.value[l].values=[...e]}},Le=async e=>{try{await $(e)}catch(l){console.error(l)}},Me=async e=>{e&&await e.validate((e,a)=>{if(e){if(0===ke.cid)return void k({message:"请选择栏目^_^",type:"success"});(async()=>{try{const e={...ke};e.attr=ke.attr.toString(),e.tagId=ke.tagId.toString(),!ke.img&&be.value&&(ke.img=te(ke.content)[0]),!ke.description&&_e.value&&(ke.description=ue(ke.content).substr(0,255));const a=Ce.value.reduce((e,l)=>(e[l.ename]=Array.isArray(l.values)?JSON.stringify(l.values):l.values,e),{}),t=await H({defaultParams:e,fieldParams:a});200===t.code?(k({message:"新增成功^_^",type:"success"}),l.go(-1)):k({message:t.msg,type:"error"})}catch(e){console.error(e)}})()}else ae(a)})};return I(async()=>{await(async()=>{try{const e=await N();if(200===e.code){const l=ee(le(e.data)),a=ee(e.data);ye.value=a,ge.value=[...l]}}catch(e){console.error(e)}})(),await Oe(),await(async()=>{try{const e=await Q();200===e.code&&(Ve.value=e.data.filter(e=>!["404.html","500.html"].includes(e)).map(e=>({label:e,value:e})))}catch(e){console.error(e)}})()}),(e,l)=>{const k=a,C=t,A=s,I=o,M=d,N=n,G=r,$=c,H=i,K=m,Q=S("MostlyCloudy"),Z=f,X=v,ee=p,le=g,ae=y,te=V,ue=u,ye=b,je=w,Ue=h,Se=j,Pe=S("ZoomIn"),Ne=S("Delete"),Ge=x,$e=S("Plus"),He=U,Ke=_;return z(),D("div",de,[O("div",oe,[R(C,{modelValue:ve.value,"onUpdate:modelValue":l[0]||(l[0]=e=>ve.value=e),onTabClick:qe},{default:P(()=>[R(k,{label:"基本信息",name:"first"}),R(k,{label:"扩展信息",name:"second"}),Ce.value.length>0?(z(),T(k,{key:0,label:"模型信息",name:"three"})):q("",!0)]),_:1},8,["modelValue"])]),O("div",se,[R(He,{ref_key:"paramsRef",ref:xe,model:ke,"label-width":"90px"},{default:P(()=>[E((z(),D("div",null,[R(ue,{gutter:20},{default:P(()=>[R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"文章栏目"},{default:P(()=>[R(A,{props:pe,"show-all-levels":!1,modelValue:me.value,"onUpdate:modelValue":l[1]||(l[1]=e=>me.value=e),options:ge.value,onChange:Re},null,8,["modelValue","options"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"文章标题",prop:"title",rules:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:1,max:100,message:"标题不能超过100个字",trigger:"blur"}]},{default:P(()=>[R(N,{modelValue:ke.title,"onUpdate:modelValue":l[2]||(l[2]=e=>ke.title=e)},null,8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"tag标签"},{default:P(()=>[R(G,{modelValue:ke.tagId,"onUpdate:modelValue":l[3]||(l[3]=e=>ke.tagId=e),options:we.value,placeholder:"请选择标签",style:{width:"240px"},multiple:"",filterable:"",remote:"","remote-method":Oe},null,8,["modelValue","options"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"内容属性"},{default:P(()=>[R(H,{modelValue:ke.attr,"onUpdate:modelValue":l[4]||(l[4]=e=>ke.attr=e)},{default:P(()=>[R($,{label:"1",value:"1"},{default:P(()=>[...l[24]||(l[24]=[B("头条",-1)])]),_:1}),R($,{label:"2",value:"2"},{default:P(()=>[...l[25]||(l[25]=[B("推荐",-1)])]),_:1}),R($,{label:"3",value:"3"},{default:P(()=>[...l[26]||(l[26]=[B("轮播",-1)])]),_:1}),R($,{label:"4",value:"4"},{default:P(()=>[...l[27]||(l[27]=[B("热门",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"发布时间"},{default:P(()=>[R(K,{modelValue:ke.createdAt,"onUpdate:modelValue":l[5]||(l[5]=e=>ke.createdAt=e),"default-value":new Date,type:"datetime",placeholder:"选择日期时间"},null,8,["modelValue","default-value"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{class:"flex",label:"缩略图"},{default:P(()=>[R(ee,{class:"avatar-uploader","http-request":Be,"show-file-list":!1,"before-upload":Ee},{default:P(()=>[R(X,{placement:"top-start",title:"上传",width:200,trigger:"hover",content:"上传图片作为封面图，大小200k内"},{reference:P(()=>[R(Z,{class:"avatar-uploader-icon"},{default:P(()=>[R(Q)]),_:1})]),_:1})]),_:1}),ke.img?(z(),T(X,{key:0,placement:"right",width:400,trigger:"hover"},{reference:P(()=>[R(le,{class:"avatar-uploader-icon pointer ml-10",src:ke.img},null,8,["src"])]),default:P(()=>[R(le,{style:{width:"100%"},src:ke.img},null,8,["src"])]),_:1})):q("",!0),R(ae,{type:"primary",class:"ml-10",onClick:l[6]||(l[6]=e=>De.value=!0)},{default:P(()=>[...l[28]||(l[28]=[B(" 默认封面图 ",-1)])]),_:1}),R(te,{modelValue:De.value,"onUpdate:modelValue":l[7]||(l[7]=e=>De.value=e),title:"默认封面图",class:"w-300","with-header":!1},{default:P(()=>[O("div",ne,[(z(!0),D(F,null,J(ze.value,(e,l)=>(z(),T(le,{key:l,src:e,onClick:l=>{return a=e,void(ke.img=a);var a},fit:"cover"},null,8,["src","onClick"]))),128))])]),_:1},8,["modelValue"]),R(N,{class:"ml-10 flex-1",modelValue:ke.img,"onUpdate:modelValue":l[8]||(l[8]=e=>ke.img=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),R(I,{label:"内容摘要"},{default:P(()=>[R(N,{type:"textarea",rows:2,placeholder:"请输入内容",modelValue:ke.description,"onUpdate:modelValue":l[9]||(l[9]=e=>ke.description=e)},null,8,["modelValue"])]),_:1}),R(I,{label:"文章内容"},{default:P(()=>[R(W,{modelValue:ke.content,"onUpdate:modelValue":l[10]||(l[10]=e=>ke.content=e),setting:Y,onInit:Te,"script-src":"/public/admin/tinymce/tinymce.min.js"},null,8,["modelValue","setting"])]),_:1}),R(ue,{gutter:20},{default:P(()=>[R(M,{sm:24,md:12,lg:8},{default:P(()=>[R(I,{label:"自动封面"},{default:P(()=>[R($,{modelValue:be.value,"onUpdate:modelValue":l[12]||(l[12]=e=>be.value=e)},{default:P(()=>[l[29]||(l[29]=B(" 文章第 ",-1)),R(N,{modelValue:he.value,"onUpdate:modelValue":l[11]||(l[11]=e=>he.value=e),class:"w-80 mr-8 ml-8",placeholder:"请输入内容"},null,8,["modelValue"]),l[30]||(l[30]=B("张图 ",-1))]),_:1},8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12,lg:8},{default:P(()=>[R(I,{label:"提取描述"},{default:P(()=>[R($,{modelValue:_e.value,"onUpdate:modelValue":l[13]||(l[13]=e=>_e.value=e)},{default:P(()=>[...l[31]||(l[31]=[B("提取文章描述",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12,lg:8},{default:P(()=>[R(I,{label:"是否显示"},{default:P(()=>[R(ye,{modelValue:ke.status,"onUpdate:modelValue":l[14]||(l[14]=e=>ke.status=e),value:"0"},{default:P(()=>[...l[32]||(l[32]=[B("发布",-1)])]),_:1},8,["modelValue"]),R(ye,{modelValue:ke.status,"onUpdate:modelValue":l[15]||(l[15]=e=>ke.status=e),value:"1"},{default:P(()=>[...l[33]||(l[33]=[B("不发布",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])),[[L,0==fe.value],[Ke,ce.value]]),E(O("div",null,[R(ue,{gutter:20},{default:P(()=>[R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"短标题",prop:"name"},{default:P(()=>[R(N,{modelValue:ke.shortTitle,"onUpdate:modelValue":l[16]||(l[16]=e=>ke.shortTitle=e)},null,8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"内容模板"},{default:P(()=>[R(Ue,{modelValue:ke.articleView,"onUpdate:modelValue":l[17]||(l[17]=e=>ke.articleView=e),placeholder:"请选择模板"},{default:P(()=>[(z(!0),D(F,null,J(Ve.value,e=>(z(),T(je,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"来源"},{default:P(()=>[R(N,{modelValue:ke.source,"onUpdate:modelValue":l[18]||(l[18]=e=>ke.source=e)},null,8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"作者"},{default:P(()=>[R(N,{modelValue:ke.author,"onUpdate:modelValue":l[19]||(l[19]=e=>ke.author=e)},null,8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"外链跳转"},{default:P(()=>[R(N,{modelValue:ke.link,"onUpdate:modelValue":l[20]||(l[20]=e=>ke.link=e),max:"120"},null,8,["modelValue"])]),_:1})]),_:1}),R(M,{sm:24,md:12},{default:P(()=>[R(I,{label:"浏览数"},{default:P(()=>[R(N,{modelValue:ke.pv,"onUpdate:modelValue":l[21]||(l[21]=e=>ke.pv=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})],512),[[L,1==fe.value]]),E(O("div",null,[R(ue,{gutter:20},{default:P(()=>[(z(!0),D(F,null,J(Ce.value,(e,a)=>(z(),T(M,{key:a,sm:24,md:24,lg:24},{default:P(()=>[["1","7"].includes(e.type)?(z(),T(I,{key:0,label:e.cname},{default:P(()=>[R(N,{modelValue:e.values,"onUpdate:modelValue":l=>e.values=l,max:"120"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):["2","9"].includes(e.type)?(z(),T(I,{key:1,label:e.cname},{default:P(()=>[R(N,{type:"textarea",rows:4,placeholder:"请输入内容",modelValue:e.values,"onUpdate:modelValue":l=>e.values=l},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):["4"].includes(e.type)?(z(),T(I,{key:2,label:e.cname},{default:P(()=>[R(Se,{modelValue:e.values,"onUpdate:modelValue":l=>e.values=l},{default:P(()=>[(z(!0),D(F,null,J(e.defaultVal,e=>(z(),T(ye,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):["3","5"].includes(e.type)?(z(),T(I,{key:3,label:e.cname},{default:P(()=>[R(Ue,{modelValue:e.values,"onUpdate:modelValue":l=>e.values=l,placeholder:"请选择"},{default:P(()=>[(z(!0),D(F,null,J(e.defaultVal,e=>(z(),T(je,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])):"6"===e.type?(z(),T(I,{key:4,label:e.cname},{default:P(()=>[R(K,{modelValue:e.values,"onUpdate:modelValue":l=>e.values=l,"default-value":new Date,type:"datetime",placeholder:"请选择"},null,8,["modelValue","onUpdate:modelValue","default-value"])]),_:2},1032,["label"])):"8"===e.type?(z(),T(I,{key:5,label:e.cname,class:"flex align-c justify-center"},{default:P(()=>[e?.values?.length>0?(z(),D("div",re,[(z(!0),D(F,null,J(e.values,(e,l)=>(z(),D("div",{class:"pos-r img-item",key:l},[(z(),T(le,{key:l,src:e.url,fit:"cover"},null,8,["src"])),O("div",ie,[R(Z,{onClick:l=>(async e=>{Ae.value=e.url,Ie.value=!0})(e)},{default:P(()=>[R(Pe)]),_:1},8,["onClick"]),R(Z,{onClick:l=>(async e=>{Ce.value.forEach((l,a)=>{Array.isArray(l.values)&&l.values.forEach((a,t)=>{a.url===e.url&&(Le(e.url),l.values.splice(t,1))})})})(e)},{default:P(()=>[R(Ne)]),_:1},8,["onClick"])])]))),128))])):q("",!0),R(Ge,{modelValue:Ie.value,"onUpdate:modelValue":l[22]||(l[22]=e=>Ie.value=e)},{default:P(()=>[R(le,{"w-full":"",src:Ae.value,alt:"Preview Image"},null,8,["src"])]),_:1},8,["modelValue"]),R(ee,{multiple:"","http-request":Je,data:{...e,index:a},"before-upload":Fe,limit:10,"show-file-list":!1},{default:P(()=>[R(Z,{class:"upload-icon"},{default:P(()=>[R($e)]),_:1})]),_:1},8,["data"])]),_:2},1032,["label"])):q("",!0)]),_:2},1024))),128))]),_:1})],512),[[L,2==fe.value&Ce.value.length>0]]),R(I,null,{default:P(()=>[R(ae,{type:"primary",onClick:l[23]||(l[23]=e=>Me(xe.value))},{default:P(()=>[...l[34]||(l[34]=[B("保存",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])])}}},[["__scopeId","data-v-ea353216"]]))}}});
