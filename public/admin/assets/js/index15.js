import{g as N,u as P,v as U,x as j,y as A,a as u}from"./element-plus.js";import{u as I}from"./vue-router.js";import{H as J,F as q,J as z}from"./@element-plus.js";import{l as F,a as H,g as K}from"./gather.js";import{c as O}from"./article.js";import{_ as G}from"./index.js";import{r as c,V as L,n as Q,ai as W,aq as X,c as Y,o as y,U as e,K as i,R as m,J as x,a2 as h,O as Z,u as v}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";import"./@fingerprintjs.js";import"./tslib.js";/* empty css     */const tt={class:"bg-fff radius-6 pd-20"},et={__name:"index",setup(ot){const E=I(),b=c([]),D=c([]),k=c(0),C=c(1),S=c(0),s=L({cid:0,title:"",shortTitle:"",tagId:"",attr:[],articleView:"",source:"",author:"",description:"",img:"",content:"欢迎使用ChanCMS系统",status:"0",pv:1,link:""}),_=async()=>{try{let t=await F(C.value);t.code===200&&(b.value=[...t.data.list],k.value=t.data.count)}catch(t){console.error("Error fetching list:",t)}},T=t=>{C.value=t,_()},B=t=>{D.value=t},R=async t=>{var a;try{let{targetUrl:o,title:f,parseData:d,cid:r,status:g}=t,p=await K({targetUrl:o,title:f,parseData:d});if(p.code===200){const{title:l,content:n}=p.data;s.attr=((a=s==null?void 0:s.attr)==null?void 0:a.toString())||"",s.title=l,s.content=n,s.cid=r,s.status=g===1?1:0,V(),u({message:"内功获取成功^_^",type:"success"})}}catch(o){console.error("Error running task:",o)}},V=async()=>{try{(await O({defaultParams:s,fieldParams:{}})).code===200&&u({message:"第".concat(S.value+1,"条数据完成^_^"),type:"success"})}catch(t){console.error("Error creating article:",t)}},$=t=>{let a=t.id;E.push({name:"gather-edit",params:{id:a}})},M=async t=>{let a=t.id;try{let o=await H(a);o.code===200?(u({message:"删除成功 ^_^",type:"success"}),_()):u({message:o.msg,type:"error"})}catch(o){console.error("Error deleting task:",o)}};return Q(()=>{_()}),(t,a)=>{const o=N,f=W("router-link"),d=P,r=U,g=j,p=A,l=X("permission-disabled");return y(),Y("div",tt,[e(d,{type:"flex",justify:"end"},{default:i(()=>[m((y(),x(f,{to:"/gather/add"},{default:i(()=>[e(o,{type:"primary",round:""},{default:i(()=>[...a[0]||(a[0]=[h("新增",-1)])]),_:1})]),_:1})),[[l,["editor","admin","super"]]])]),_:1}),e(g,{ref:"multipleTable",data:b.value,"tooltip-effect":"dark","row-key":"id",onSelectionChange:B},{default:i(()=>[e(r,{type:"selection"}),e(r,{prop:"id",width:"60",label:"编号"}),e(r,{prop:"taskName",label:"任务名称"}),e(r,{prop:"category",label:"所属栏目"}),e(r,{prop:"targetUrl",label:"接口链接"}),e(r,{prop:"status",label:"状态"},{default:i(n=>[h(Z(n.row.status==1?"草稿":"发布"),1)]),_:1}),e(r,{prop:"updatedAt",label:"发布时间"}),e(r,{fixed:"right",width:"222",label:"操作"},{default:i(n=>[m(e(o,{icon:v(J),circle:"",onClick:w=>$(n.row)},null,8,["icon","onClick"]),[[l,["editor","admin","super"]]]),m(e(o,{icon:v(q),circle:"",onClick:w=>M(n.row)},null,8,["icon","onClick"]),[[l,["editor","admin","super"]]]),m((y(),x(o,{type:"primary",round:"",icon:v(z),onClick:w=>R(n.row)},{default:i(()=>[...a[1]||(a[1]=[h("执行",-1)])]),_:1},8,["icon","onClick"])),[[l,["editor","admin","super"]]])]),_:1})]),_:1},8,["data"]),e(d,{type:"flex",class:"mt-20 align-c",justify:"center"},{default:i(()=>[e(p,{background:"",layout:"prev, pager, next",onCurrentChange:T,"page-size":10,total:k.value,"hide-on-single-page":""},null,8,["total"])]),_:1})])}}},Dt=G(et,[["__scopeId","data-v-3f52528e"]]);export{Dt as default};
