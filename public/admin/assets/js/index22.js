import{G as he,X as xe,g as ge,b as ye,u as be,K as Ce,a as M}from"./element-plus.js";import{V as ke}from"./vue3-ace-editor.js";import"./ace-builds.js";import{g as U,a as we,s as Fe}from"./codefile.js";import{_ as Ee}from"./index.js";import{r as n,e as W,n as Ne,p as Le,aj as h,c as y,o as d,O as o,a as s,L as l,a3 as p,Q as m,K as G,J as H,u as Te,H as je,I as Se,ac as Be}from"./@vue.js";import"./dayjs.js";import"./@element-plus.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./resize-observer-polyfill.js";import"./js-cookie.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./vue-router.js";import"./axios.js";import"./nprogress.js";/* empty css     */const Me={class:"editor-container bg-fff"},Ae={class:"main-content",style:{height:"calc(100vh - 90px)"}},Ie={span:4,class:"file-tree overflow-auto bg-gray-800"},Ve={class:"tree-node flex items-center"},$e={class:"node-label"},Je={span:20,class:"editor-area bg-gray-900"},ze={key:0,class:"editor-wrapper h-full relative"},Oe={class:"status-bar absolute bottom-0 left-0 right-0 bg-gray-800 text-gray-400 text-xs p-2 flex justify-between"},Pe={class:"ml-3"},Re={key:0},Ue={key:1,class:"welcome-screen h-full flex flex-col justify-center items-center text-gray-500"},We={class:"supported-files flex mt-8 gap-6"},Ge={__name:"index",setup(He){const T=n([]),b=n([]),K=n("/"),f=n(null),x=n(""),j=n(""),C=n(!1),v=n(null),i=n(null),g=n(!1),E=n(!1),N=n(null),A=n(""),I=n(!1),k=n("html"),V=t=>{k.value=t,console.log("type--->",t),S()},D=n([{ext:"html",name:"HTML",color:"text-pink-400"},{ext:"css",name:"CSS",color:"text-green-400"},{ext:"js",name:"JavaScript",color:"text-blue-400"},{ext:"json",name:"JSON",color:"text-yellow-400"}]),Q=W(()=>({fontSize:14,tabSize:2,useWorker:!0,showPrintMargin:E.value,showLineNumbers:!0,highlightActiveLine:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,behavioursEnabled:!0,wrap:g.value})),X={children:"children",label:"name"},q=W(()=>{if(!f.value)return"text";switch($(f.value.name)){case"html":return"html";case"css":return"css";case"js":return"javascript";case"json":return"json";default:return"text"}}),Y=(t,e)=>t?e.name.toLowerCase().includes(t.toLowerCase()):!0;Ne(()=>{S()});const $=t=>t.split(".").pop()||"",Z=t=>/\.html?$/.test(t),ee=t=>/\.js$/.test(t),te=t=>/\.css$/.test(t),oe=t=>/\.json$/.test(t),le=t=>{i.value=t,t.setOptions({enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0}),t.selection.on("changeCursor",()=>{N.value=t.selection.getCursor()})},ne=()=>{C.value=x.value!==j.value},J=async t=>{try{const e=await we({path:t.path});if(e.code==200){const u=e.data;x.value=u,j.value=u,C.value=!1;const a=$(t.name);A.value=a.toUpperCase(),f.value=t}}catch(e){console.error("打开文件失败:",e),M.error("打开文件失败，请重试")}},se=async()=>{if(!(!f.value||!C.value))try{await Fe({path:f.value.path,content:x.value}),j.value=x.value,C.value=!1,M.success("文件保存成功")}catch(t){console.error("保存文件失败:",t),M.error("保存文件失败，请重试")}},z=t=>{v.value&&setTimeout(()=>{try{const e=v.value.getNode(t);e&&!e.expanded&&v.value.store.setExpanded(t,!0)}catch(e){console.warn("展开节点失败",e)}},100)},S=async()=>{try{const t=await U({type:k.value});T.value=t.data,b.value=t.data,Le(()=>{if(v.value&&!I.value&&b.value.length>0){const e=b.value.find(u=>u.type==="file");e&&(O(e),J(e)),I.value=!0}})}catch(t){console.error("加载文件树失败:",t)}},ae=()=>{i.value&&i.value.execCommand("find")},re=()=>{i.value&&i.value.execCommand("replace")},ie=()=>{i.value&&i.value.execCommand("gotoline")},ue=()=>{g.value=!g.value,i.value&&i.value.session.setUseWrapMode(g.value)},ce=()=>{E.value=!E.value},O=(t,e)=>{v.value&&t.path&&v.value.setCurrentKey(t.path),t.type==="file"?J(t):(K.value=t.path,!e.childNodes||e.childNodes.length===0?pe(t.path):z(t.path))},pe=async t=>{try{const e=await U({type:k.value}),u=(a,r,L)=>{for(let w=0;w<a.length;w++){const _=a[w];if(_.path===r)return _.children=L,!0;if(_.children&&_.children.length&&u(_.children,r,L))return!0}return!1};u(T.value,t,e.data),b.value=[...T.value],z(t)}catch(e){console.error("加载子目录失败:",e)}};return(t,e)=>{var R;const u=h("document-add"),a=ye,r=ge,L=h("refresh"),w=h("search"),_=h("position"),de=h("border"),me=xe,fe=he,P=be,ve=h("folder"),B=h("document"),_e=Ce;return d(),y("div",Me,[o(P,{class:"toolbar bg-gray-800 text-white"},{default:l(()=>[o(fe,{span:24,class:"flex items-center"},{default:l(()=>[o(me,{gap:"0"},{default:l(()=>[o(r,{type:"primary",onClick:se,disabled:!C.value},{default:l(()=>[o(a,null,{default:l(()=>[o(u)]),_:1}),e[3]||(e[3]=p(" 保存 ",-1))]),_:1,__:[3]},8,["disabled"]),o(r,{onClick:S},{default:l(()=>[o(a,null,{default:l(()=>[o(L)]),_:1}),e[4]||(e[4]=p(" 刷新 ",-1))]),_:1,__:[4]}),o(r,{onClick:ae},{default:l(()=>[o(a,null,{default:l(()=>[o(w)]),_:1}),e[5]||(e[5]=p(" 搜索 ",-1))]),_:1,__:[5]}),o(r,{onClick:re},{default:l(()=>[o(a),e[6]||(e[6]=p(" 替换 ",-1))]),_:1,__:[6]}),o(r,{onClick:ie},{default:l(()=>[o(a,null,{default:l(()=>[o(_)]),_:1}),e[7]||(e[7]=p(" 跳转 ",-1))]),_:1,__:[7]}),o(r,{onClick:ue},{default:l(()=>[o(a,null,{default:l(()=>e[8]||(e[8]=[s("switch",null,null,-1)])),_:1,__:[8]}),p(" "+m(g.value?"不换行":"换行"),1)]),_:1}),o(r,{onClick:ce},{default:l(()=>[o(a,null,{default:l(()=>[o(de)]),_:1}),p(" "+m(E.value?"隐藏边线":"显示边线"),1)]),_:1})]),_:1})]),_:1})]),_:1}),s("div",Ae,[s("div",Ie,[o(P,{class:"mb-4 pd-10"},{default:l(()=>[o(r,{type:k.value=="html"?"primary":"default",onClick:e[0]||(e[0]=c=>V("html"))},{default:l(()=>e[9]||(e[9]=[p("html",-1)])),_:1,__:[9]},8,["type"]),o(r,{type:k.value=="css"?"primary":"default",onClick:e[1]||(e[1]=c=>V("static"))},{default:l(()=>e[10]||(e[10]=[p("static",-1)])),_:1,__:[10]},8,["type"])]),_:1}),o(_e,{ref_key:"treeRef",ref:v,data:b.value,props:X,"filter-node-method":Y,"node-key":"path","highlight-current":"","current-node-key":(R=f.value)==null?void 0:R.path,onNodeClick:O},{default:l(({node:c,data:F})=>[s("span",Ve,[o(a,{class:"mr-2"},{default:l(()=>[F.type==="directory"?(d(),G(ve,{key:0,class:"text-amber-400"})):(d(),G(B,{key:1,class:H({"text-blue-400":ee(F.name),"text-pink-400":Z(F.name),"text-green-400":te(F.name),"text-yellow-400":oe(F.name)})},null,8,["class"]))]),_:2},1024),s("span",$e,m(c.label),1)])]),_:1},8,["data","current-node-key"])]),s("div",Je,[f.value?(d(),y("div",ze,[o(Te(ke),{value:x.value,"onUpdate:value":e[2]||(e[2]=c=>x.value=c),lang:q.value,theme:"monokai",style:{height:"100%"},options:Q.value,onInit:le,onChange:ne},null,8,["value","lang","options"]),s("div",Oe,[s("div",null,[s("span",null,m(A.value),1),e[11]||(e[11]=s("span",{class:"ml-3"},"编码: UTF-8",-1)),s("span",Pe,m(g.value?"换行":"不换行"),1)]),s("div",null,[N.value?(d(),y("span",Re,"行 "+m(N.value.row+1)+", 列 "+m(N.value.column+1),1)):je("",!0)])])])):(d(),y("div",Ue,[o(a,{class:"text-5xl mb-4"},{default:l(()=>[o(B)]),_:1}),e[12]||(e[12]=s("h2",{class:"text-xl mb-2"},"欢迎使用在线文件编辑器",-1)),e[13]||(e[13]=s("p",null,"请从左侧文件树中选择一个文件进行编辑",-1)),s("div",We,[(d(!0),y(Se,null,Be(D.value,c=>(d(),y("div",{class:"file-type flex flex-col items-center",key:c.ext},[o(a,{class:H([c.color,"text-4xl mb-2"])},{default:l(()=>[o(B)]),_:2},1032,["class"]),s("span",null,m(c.name),1)]))),128))])]))])])])}}},vt=Ee(Ge,[["__scopeId","data-v-ff467741"]]);export{vt as default};
