import{I as M,r as R,s as q,S as D,T as N,b as S,U as F,g as T,q as j,a as i}from"./element-plus.js";import{u as z}from"./vue-router.js";import{c as G}from"./slide.js";import{u as J}from"./upload.js";import{t as K,_ as L}from"./tinymce.js";import{_ as O}from"./index.js";import{r as f,V as _,n as P,ai as $,c as A,o as p,R as H,J as g,K as l,U as t,G as Q,a2 as W}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./@element-plus.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./js-cookie.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./nprogress.js";import"./@fingerprintjs.js";import"./tslib.js";/* empty css     */const X={class:"bg-fff pd-20 radius-6"},Y={__name:"add",setup(Z){const y=z(),c=f(null),U=_(K),m=f(!0);P(async()=>{m.value=!1});const v=()=>{m.value=!1},b={imgUrl:[{required:!0,message:"请上传图片",trigger:"blur"}]},o=_({title:"",imgUrl:"",content:"",linkUrl:""}),V=a=>a.type.indexOf("image")===-1?(i("上传文件只能是图片格式"),!1):a.size/1024/1024>.2?(i("上传图片必须小于200k"),!1):!0,k=async a=>{const e=new FormData;e.append("file",a.file);const s=await J(e,"1");s.code===200&&(o.imgUrl=s.data.path)},E=()=>{c.value.validate(async a=>{if(a)try{const e=await G(o);e.code===200?(i({message:"新增成功^_^",type:"success"}),y.back()):i({message:e.msg,type:"error"})}catch(e){console.error(e)}else console.log("error submit!!")})};return(a,e)=>{const s=q,n=R,w=$("MostlyCloudy"),x=S,u=N,h=D,d=F,I=T,C=j,B=M;return p(),A("div",X,[H((p(),g(C,{model:o,rules:b,ref_key:"formRef",ref:c,"label-width":"84px",class:"mt-20"},{default:l(()=>[t(n,{label:"轮播标题",prop:"title"},{default:l(()=>[t(s,{modelValue:o.title,"onUpdate:modelValue":e[0]||(e[0]=r=>o.title=r)},null,8,["modelValue"])]),_:1}),t(n,{class:"flex",label:"轮播图"},{default:l(()=>[t(h,{class:"avatar-uploader","http-request":k,"show-file-list":!1,"before-upload":V},{default:l(()=>[t(u,{placement:"top-start",title:"上传",width:200,trigger:"hover",content:"上传图片作为封面图，大小200k内"},{reference:l(()=>[t(x,{class:"avatar-uploader-icon"},{default:l(()=>[t(w)]),_:1})]),_:1})]),_:1}),o.imgUrl?(p(),g(u,{key:0,placement:"right",width:600,trigger:"hover"},{reference:l(()=>[t(d,{class:"avatar-uploader-icon pointer ml-10",src:o.imgUrl},null,8,["src"])]),default:l(()=>[t(d,{style:{width:"100%"},src:o.imgUrl},null,8,["src"])]),_:1})):Q("",!0),t(s,{class:"ml-10 flex-1",modelValue:o.imgUrl,"onUpdate:modelValue":e[1]||(e[1]=r=>o.imgUrl=r)},null,8,["modelValue"])]),_:1}),t(n,{label:"轮播链接"},{default:l(()=>[t(s,{modelValue:o.linkUrl,"onUpdate:modelValue":e[2]||(e[2]=r=>o.linkUrl=r)},null,8,["modelValue"])]),_:1}),t(n,{label:"轮播文案"},{default:l(()=>[t(L,{modelValue:o.content,"onUpdate:modelValue":e[3]||(e[3]=r=>o.content=r),setting:U,onInit:v,"script-src":"/public/admin/tinymce/tinymce.min.js"},null,8,["modelValue","setting"])]),_:1}),t(n,null,{default:l(()=>[t(I,{type:"primary",onClick:E},{default:l(()=>[...e[4]||(e[4]=[W("保存",-1)])]),_:1})]),_:1})]),_:1},8,["model"])),[[B,m.value]])])}}},we=O(Y,[["__scopeId","data-v-7342250b"]]);export{we as default};
