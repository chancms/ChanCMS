import{r as t,p as e,ap as n,M as s,aq as o,a8 as a,L as c,aa as r,ao as i,b as u,A as p,J as f,K as l,D as h,ar as y}from"./@vue.js";let d;const b=t=>d=t,v=Symbol();function _(t){return t&&"object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)&&"function"!=typeof t.toJSON}var j,O;function $(){const e=n(!0),s=e.run(()=>t({}));let o=[],a=[];const c=i({install(t){b(c),c._a=t,t.provide(v,c),t.config.globalProperties.$pinia=c,a.forEach(t=>o.push(t)),a=[]},use(t){return this._a?o.push(t):a.push(t),this},_p:o,_a:null,_e:e,_s:new Map,state:s});return c}(O=j||(j={})).direct="direct",O.patchObject="patch object",O.patchFunction="patch function";const m=()=>{};function g(t,e,n,s=m){t.push(e);const o=()=>{const n=t.indexOf(e);n>-1&&(t.splice(n,1),s())};return!n&&f()&&l(o),o}function S(t,...e){t.slice().forEach(t=>{t(...e)})}const P=t=>t(),E=Symbol(),w=Symbol();function M(t,e){t instanceof Map&&e instanceof Map?e.forEach((e,n)=>t.set(n,e)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const a=e[n],c=t[n];_(c)&&_(a)&&t.hasOwnProperty(n)&&!s(a)&&!o(a)?t[n]=M(c,a):t[n]=a}return t}const x=Symbol();function A(t){return!_(t)||!Object.prototype.hasOwnProperty.call(t,x)}const{assign:I}=Object;function F(t){return!(!s(t)||!t.effect)}function J(r,i,u={},f,l,h){let y;const d=I({actions:{}},u),v={deep:!0};let _,O,$,x=[],J=[];const k=f.state.value[r];let q;function C(t){let e;_=O=!1,"function"==typeof t?(t(f.state.value[r]),e={type:j.patchFunction,storeId:r,events:$}):(M(f.state.value[r],t),e={type:j.patchObject,payload:t,storeId:r,events:$});const n=q=Symbol();c().then(()=>{q===n&&(_=!0)}),O=!0,S(x,e,f.state.value[r])}h||k||(f.state.value[r]={}),t({});const D=h?function(){const{state:t}=u,e=t?t():{};this.$patch(t=>{I(t,e)})}:m;const K=(t,e="")=>{if(E in t)return t[w]=e,t;const n=function(){b(f);const e=Array.from(arguments),s=[],o=[];let a;S(J,{args:e,name:n[w],store:N,after:function(t){s.push(t)},onError:function(t){o.push(t)}});try{a=t.apply(this&&this.$id===r?this:N,e)}catch(c){throw S(o,c),c}return a instanceof Promise?a.then(t=>(S(s,t),t)).catch(t=>(S(o,t),Promise.reject(t))):(S(s,a),a)};return n[E]=!0,n[w]=e,n},L={_p:f,$id:r,$onAction:g.bind(null,J),$patch:C,$reset:D,$subscribe(t,e={}){const n=g(x,t,e.detached,()=>s()),s=y.run(()=>p(()=>f.state.value[r],n=>{("sync"===e.flush?O:_)&&t({storeId:r,type:j.direct,events:$},n)},I({},v,e)));return n},$dispose:function(){y.stop(),x=[],J=[],f._s.delete(r)}},N=e(L);f._s.set(r,N);const W=(f._a&&f._a.runWithContext||P)(()=>f._e.run(()=>(y=n()).run(()=>i({action:K}))));for(const t in W){const e=W[t];if(s(e)&&!F(e)||o(e))h||(k&&A(e)&&(s(e)?e.value=k[t]:M(e,k[t])),f.state.value[r][t]=e);else if("function"==typeof e){const n=K(e,t);W[t]=n,d.actions[t]=e}}return I(N,W),I(a(N),W),Object.defineProperty(N,"$state",{get:()=>f.state.value[r],set:t=>{C(e=>{I(e,t)})}}),f._p.forEach(t=>{I(N,y.run(()=>t({store:N,app:f._a,pinia:f,options:d})))}),k&&h&&u.hydrate&&u.hydrate(N.$state,k),_=!0,O=!0,N}function k(t,e,n){let s;const o="function"==typeof e;function a(n,a){const c=y();(n=n||(c?h(v,null):null))&&b(n),(n=d)._s.has(t)||(o?J(t,e,s,n):function(t,e,n){const{state:s,actions:o,getters:a}=e,c=n.state.value[t];let p;p=J(t,function(){c||(n.state.value[t]=s?s():{});const e=r(n.state.value[t]);return I(e,o,Object.keys(a||{}).reduce((e,s)=>(e[s]=i(u(()=>{b(n);const e=n._s.get(t);return a[s].call(e,e)})),e),{}))},e,n,0,!0)}(t,s,n));return n._s.get(t)}return s=o?n:e,a.$id=t,a}export{$ as c,k as d};
